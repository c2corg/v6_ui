<%!
from c2corg_ui.templates.utils import get_lang_lists
%>
<%namespace file="helpers/detailed_profile_attributes.html" import="get_profile_general"/>
<%namespace file="../helpers/view.html" import="get_comments, get_image_gallery,
    photoswipe_gallery,
    show_attr, show_missing_langs_links, show_other_langs_links, show_archive_data,
    show_float_buttons, show_badge, get_document_description"/>

% if not_found:
  <header class="view-details-title">
    <h1>
      <span translate>Unknown user</span>
      ${show_badge(None, 'profile')}
    </h1>
  </header>

  <section class="view-details-section">
    <div class="view-details-description col-xs-12  description">
      <span class="lead">
        <div id="document-description" class="collapse in" translate>No user profile found</div>
      </span>
    </div>
  </section>

% elif not_authorized:
  <header class="view-details-title">
    <h1>
      <span>${profile['name']}</span>
      ${show_badge(None, 'profile')}
    </h1>
  </header>

  <section class="view-details-section">
    <div class="view-details-description col-xs-12  description">
      <span class="lead">
        <div id="document-description" class="collapse in" translate>This profile is only available to authenticated users.</div>
      </span>
    </div>
  </section>

% else:
  <%
      user_id = profile['document_id']
      other_langs, missing_langs = get_lang_lists(profile, lang)
  %>

  <header class="view-details-title">
    <h1>
      <span>${profile['name']}</span>
      ${show_badge(profile, 'profile')}
    </h1>
  </header>

  <app-map class="view-details-map"></app-map>

  <section class="view-details-section">

    % if version:
      ${show_archive_data('profiles', profile, locale, version)}
    % endif

    % if not version:
      ${get_image_gallery()}
    % endif

    <div class="view-details-informations col-xs-12  informations">
      <h3 class="heading informations" ng-click="mainCtrl.animateHeaderIcon($event)" data-toggle="collapse" data-target="#document-informations">
        <span translate>Informations</span><span class="glyphicon glyphicon-menu-down"></span>
      </h3>
      <section id="document-informations" class="collapse in">
        ${get_profile_general(profile)}
      </section>
    </div>

    ${get_document_description(locale, 'profile')}

    ## FIXME Really?
    ${get_comments()}

    % if not version:
      <p>HERE COMES THE USER FEED</p>
    % endif

    ## OTHER BUTTON contents
    % if not version:
      ##${show_other_langs_links('profiles', profile, other_langs)}
      ##${show_missing_langs_links('profiles', profile, missing_langs)}
      ##${show_float_buttons(None, 'profiles', user_id, lang, other_langs, missing_langs)}
    % endif

  </section>

  ## FIXME: move to main view template?
  ${photoswipe_gallery()}

  <script>
    window.onload = function() {
       // init float-buttons tooltips
       $('[data-toggle=\'tooltip\']').tooltip();
    };
  </script>
% endif
